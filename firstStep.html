<html>
	<head>
		<title> First Step </title>
		<meta name="Description" content="Insertion and extraction of json file, and graphical representation of its content" >
		<style type="text/css">
			body {
        margin: 0px;
        padding: 0px;
      }
      #firstGraph, #secondGraph {
        width : 300px;
        height: 197px;
        margin: 8px auto;
      }
		</style>
	</head>
	<body>
		<div id="firstGraph"></div>
		<div id ="secondGraph"></div>
		<div id="dataForm">
			<form id="data" action="#">
				<input id="fieldForm" type="decimal" value="0.0" />
				<button id="formButton">Send</button>
			</form>
		</div>
		
		<script src="js/flotr2.min.js" type="text/javascript"></script>
		<script src="js/jquery-1.10.2.js" type="text/javascript"></script>
		<script src="js/jquery.cookie.js" type="text/javascript"></script>
		<script>
		
			var jsonFirstGraph = '';
			var jsonSecondGraph = '';
			
			function insertNewValue(graph,value){
			
				newObject = [graph.data.length, parseInt(value)];
				
				graph.data[graph.data.length] = newObject;
			}
		
			$('#formButton').on('click', function(){
				
				if(jsonFirstGraph == null){
				
					jsonFirstGraph = {
						'type':'area',
						'data': []
					};
					
				}else{
					jsonFirstGraph = JSON.parse(jsonFirstGraph);
				}
				
				if(jsonSecondGraph == null){
				
					jsonSecondGraph = {
						'type':'bars',
						'data': []
					};
					
				}else{
					jsonSecondGraph = JSON.parse(jsonSecondGraph);
				}
					
				insertNewValue(jsonFirstGraph, $('#fieldForm').val());
				$.cookie('firstStepFirstGraph', JSON.stringify(jsonFirstGraph));
				
				jsonFirstGraph = JSON.stringify(jsonFirstGraph);
				showGraph(jsonFirstGraph,"firstGraph");
				
				insertNewValue(jsonSecondGraph, $('#fieldForm').val());
				$.cookie('firstStepSecondGraph', JSON.stringify(jsonSecondGraph));
				
				jsonSecondGraph = JSON.stringify(jsonSecondGraph);
				showGraph(jsonSecondGraph,"secondGraph");
					
			});
		
			function showGraph(json, id){
			
				id = document.getElementById(id);
			
				data = JSON.parse(json).data;
				alert(data);
			
				graph = Flotr.draw(id, data, {
				  xaxis: {
				      minorTickFreq: 4
			    },
			    grid: {
			    	minorVerticalLines: true
				  }
				});
			}
		
			(function(){
			
				/*value = {"type":"area",
					"data":[{'x':'0','y':'0'},
					    {'x':'1','y':'1'},
					    {'x':'2','y':'2'},
					    {'x':'3','y':'3'},
					    {'x':'4','y':'4'}]
				    };
				    
				$.cookie('cookie', JSON.stringify(value));*/
				
				jsonFirstGraph = $.cookie('firstStepFirstGraph');
				jsonSecondGraph = $.cookie('firstStepSecondGraph');
				
				if(jsonFirstGraph != null)
					showGraph(jsonFirstGraph,"firstGraph");
				
				if(jsonSecondGraph != null)
					showGraph(jsonSecondGraph,"secondGraph");
				
			})();
		</script>
	</body>
</html>
